<template name="campaign">
    <div class="app-content content container-fluid">
      <div class="content-wrapper">
        <div class="content-header row">
        </div>
        <div class="content-body"><!-- stats -->
          <div class="content-header row">
            <div class="content-header-left col-md-6 col-xs-12 mb-1">
              <h2 class="content-header-title">Pure Win</h2>
            </div>
          </div>

    <div class="row">
        <div class="col-xs-12 mt-1 mb-3">
            <h4>User dashboard</h4>
            <p>New campaign</p>
            <hr>
        </div>
    </div>

<div class="col-xs-2">
  <div class="card">
    <div class="card-header">
      <h4 class="card-title">Logic</h4>
      <a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
      <div class="heading-elements">
        <ul class="list-inline mb-0">
          <li><a class="btn-card-toggle active-card flowchart-logic" data-toggle="collapse" data-target="#flowchart-logic"><i class="card-status fa fa-angle-down"></i></a></li>
        </ul>
      </div>
    </div>
    <div class="card-body collapse in" id="flowchart-logic">
      <div class="container">


          {{#each graphThumbs}}
            <div class="row">
              <div class="col-xs-12 align-center campaign-logic">
                <h5>{{name}}</h5>
                <img src="{{link}}" alt="{{name}}">
                <ul>
                {{#each terms}}
                  <li>{{this}}</li>
                {{/each}}
                </ul>
              </div>
            </div>
          {{/each}}
        </div>
    </div>
  </div>
</div>


  <div class="col-xs-10">
    <div class="card">
      <div class="card-header">
        <h4 class="card-title"><i class="icon-clipboard4"></i> New campaign</h4>
        <a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
        <div class="heading-elements">
          <ul class="list-inline mb-0">
            <li><a data-action="collapse"><i class="icon-minus4"></i></a></li>
            <!--
            <li><a data-action="reload"><i class="icon-reload"></i></a></li>
            <li><a data-action="expand"><i class="icon-expand2"></i></a></li>
            -->
            <li><a data-action="close"><i class="icon-cross2"></i></a></li>
          </ul>
        </div>
      </div>
      <div class="card-body form-body collapse in collapse in">
        <div class="card-block">
          
          <div class="card-text">
            <form class="form-horizontal">
            <div class="form-body">
              <div class="form-required-basics">
              <div class="form-group">
                <div class="campaign-name">
                  <label class="campaign-name" for="campaign-name"><h4>Campaign name</h4></label>
                  <input type="text" class="form-control bottom-border" id="campaign-name" name="campaign-name" placeholder="Specify campaign name" required>
                </div>
              </div>
              <div class="row">
                <div class="form-inline has-feedback">
                  <label for="form-campaign-dateStart" class="col-md-4 col-lg-2 control-label">Start date</label>
                  <div class="col-md-6 col-lg-3">
                    <div class="input-group">
                      <input class="form-control date-picker" id="form-campaign-dateStart" data-toggle="datepicker" placeholder="Pick a date">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default btn-resize-icon docs-datepicker-trigger" disabled>
                          <i class="icon-ei-calendar input-feedback" aria-hidden="true"></i>
                        </button>
                      </span>
                    </div>
                  </div>
                </div>

                <div class="form-inline">
                  <label for="form-campaign-dateEnd" class="col-md-4 col-lg-2 control-label">End date</label>
                  <div class="col-md-6 col-lg-3">
                    <div class="input-group">
                      <input class="form-control date-picker" id="form-campaign-dateEnd" data-toggle="datepicker" placeholder="Pick a date">
                      <span class="input-group-btn">
                        <button type="button" class="btn btn-default btn-resize-icon docs-datepicker-trigger" disabled>
                          <i class="icon-ei-calendar input-feedback" aria-hidden="true"></i>
                        </button>
                      </span>
                    </div>
                  </div>
                </div>
                <!-- tinymce -->
                <div class="col-xs-10 offset-xs-1 add-margin-top">
                  <textarea id="campaign-description">Campain description</textarea>
                </div>
              </div>
                  
              </div>
            </div>

            {{#if logicSelected}}
            <div class="form-campaign">
              <br/>
              <h5>Campaign parameters</h5>
            </div>
              <div class="campaign-parameters">

                {{#if textarea}}
                  <div class="row">
                    <div class="form-group" id="form-container-{{textarea._id}}">
                      <label for="form-campaign-{{textarea._id}}" class="col-sm-2 control-label">{{textarea.name}}</label>
                        <div class="col-sm-7">
                          <input type="text" name="campaign-input" data-name="{{textarea.name}}" data-id="{{textarea._id}}" class="form-control campaign-input" id="form-campaign-{{textarea._id}}">
                        </div>
                    </div>
                  </div>
                {{/if}}

                {{#if number}}
                  <div class="row">
                    <div class="form-group" id="form-container-{{number._id}}">
                      <label for="form-campaign-{{number._id}}" class="col-sm-2 control-label">{{number.name}}</label>
                      <div class="col-sm-2">
                        <input type="number" name="campaign-number" data-name="{{number.name}}" data-id="{{number._id}}" class="form-control campaign-number" id="form-campaign-{{_id}}">
                      </div>
                      <div class="col-sm-3">
                        <select class="form-control" name="campaign-number" id="number-function">
                          <option value="equal">Equal</option>
                          <option value="greater">Or greater</option>
                          <option value="less">Or less</option>
                          <option value="range">To</option>
                        </select>
                      </div>
                      <div class="col-sm-2 if-range"></div>
                    </div>
                  </div>
                {{/if}}

                {{#if dropbox}}
                  <div class="row">
                    <div class="form-group" id="form-container-{{dropbox._id}}">
                      <label for="form-campaign-{{dropbox.name}}" class="col-sm-2 control-label">{{dropbox.name}}</label>
                      <div class="col-sm-7">
                        <select class="form-control campaign-dropbox" name="campaign-dropbox" data-name="{{dropbox.name}}" data-id="{{dropbox._id}}" id="form-campaign-{{dropbox._id}}">
                        <option value="none" selected disabled>Select value</option>
                          {{#each dropbox.values}}
                            <option value="{{this}}">{{this}}</option>
                          {{/each}}
                        </select>
                      </div>
                    </div>
                  </div>
                {{/if}}

                {{#if single}}
                  <div class="row">
                    <div class="form-group" id="form-container-{{single._id}}">
                      <label for="form-campaign-{{single._id}}" class="col-sm-2 control-label">{{single.name}}</label>
                      <div class="col-sm-7">
                        <ul class="input-list">
                          <li>
                            <div class="pure-radiobutton">
                              <input type="radio" class="campaign-single" id="form-campaign-{{single._id}}-true" name="campaign-single" data-name="{{single.name}}" data-id="{{single._id}}" value="true">
                              <label for="form-campaign-{{single._id}}-true"> True</label>
                            </div>
                          </li>
                          <li>
                            <div class="pure-radiobutton">
                              <input type="radio" class="campaign-single" id="form-campaign-{{single._id}}-false" name="campaign-single" data-id="{{single._id}}" data-name="{{single.name}}" value="false">
                              <label for="form-campaign-{{single._id}}-false"> False</label>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>

                {{/if}}

                {{#if checkboxValue}}
                {{#each checkboxValue}}
                  <div class="row">
                    <div class="form-group" id="form-container-{{_id}}">
                      <label for="form-campaign-{{_id}}" class="col-sm-2 control-label">{{name}}</label>
                      <div class="col-sm-7">
                        <ul class="input-list">
                          {{#each values}}
                {{test}}
                          <li>
                            <div class="pure-checkbox">
                              <input type="checkbox" class="campaign-checkbox" name="campaign-checkbox" data-name="{{name}}" data-id="{{_id}}" id="checkbox-{{_id}}-{{$add @index length}}" value="{{this}}">
                              <label for="checkbox-{{_id}}-{{$add @index length}}">{{this}}</label>
                            </div>
                          </li>
                          {{/each}}
                        </ul>
                      </div>
                    </div> 
                  </div>
                  {{/each}}
                {{/if}}

                {{#if description}}
                  <div class="row">
                    <div class="form-group" id="form-container-{{description._id}}">
                      <label for="form-campaign-{{description._id}}" class="col-sm-2 control-label">{{description.name}}</label>
                      <div class="col-sm-7">
                        <textarea rows="3" name="campaign-textarea" data-name="{{description.name}}" data-id="{{description._id}}" class="form-control campaign-textarea" id="form-campaign-{{description._id}}" placeholder=""></textarea>
                      </div>
                    </div>
                  </div>
                {{/if}}

                {{#if multiselect}}
                  <script>
                    $('.campaign-multiselect').multiselect({
                        buttonClass: 'btn btn-secondary btn-multiselect',
                        numberDisplayed: 6,
                        includeSelectAllOption: true,
                        selectAllText: ' Select all',
                        selectAllValue: 'select-all-value',
                        maxHeight: 400,
                        enableFiltering: false, // change this to enable search - future feature
                        enableCaseInsensitiveFiltering: false,
                        filterPlaceholder: 'Search',
                        includeFilterClearBtn: false,
                        enableHTML: true,
                        filterBehavior: 'both',
                        templates: {
                          button: '<button type="button" class="multiselect dropdown-toggle btn-block" data-toggle="dropdown"><span class="multiselect-selected-text"></span> <b class="caret"></b></button>',
                          ul: '<ul class="multiselect-container dropdown-menu"></ul>',
                          filter: '<li class="multiselect-item filter"><div class="input-group"><span class="input-group-addon"><i class="icon-android-search"></i></span><input class="form-control multiselect-search" style="margin-left:0px" type="text"></div></li>',
                          filterClearBtn: '<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="icon-android-cancel"></i></button></span>',
                          li: '<li><a tabindex="0"><label></label></a></li>',
                          divider: '<li class="multiselect-item divider"></li>',
                          liGroup: '<li class="multiselect-item multiselect-group"><label></label></li>'
                        }
                      });
                  </script>
                  <div class="row">
                    <div class="form-group" id="form-container-{{multiselect._id}}">
                      <label for="form-campaign-{{multiselect._id}}" class="col-sm-2 control-label">{{multiselect.name}}</label>
                      <div class="col-sm-7">
                        <select class="form-control campaign-multiselect" name="campaign-multiselect" data-name="{{multiselect.name}}" data-id="{{multiselect._id}}" multiple="multiple" id="form-campaign-{{multiselect._id}}">
                          {{#each multiselect.values}}
                          <option value="{{this}}">{{this}}</option>
                          {{/each}}
                      </select>
                      </div>
                    </div>
                  </div>
                {{/if}}

              </div>
              <div class="form-actions align-children-center">
                <button type="button" class="btn btn-outline-danger reset-form mr-1">
                  <i class="icon-cross2"></i> Cancel
                </button>
                <button type="submit" id="btn-submit-campaign" class="btn btn-outline-info">
                  <i class="icon-check2"></i> Save
                </button>
              </div>
              {{/if}}
            </form>
            </div>
          </div>
        </div>
      </div>
    </div>


</div>


<div class="logic-fixed" data-spy="affix" data-offset-top="150px" >  
  <div class="logic-preview-h btn-logic-collapse"><h4>Flowchart</h4></div>
  <div id="flowchart-small">
  </div>
</div>

</div>
</div>

    <script>
    $('#form-campaign-dateStart').datepicker({
      autoclose: true,
      container: 'html',
    }).on('changeDate', function(selected){
        var startDate = new Date(selected.date.valueOf());
        startDate.setDate(startDate.getDate(new Date(selected.date.valueOf())));
        $('#form-campaign-dateEnd').datepicker('setStartDate', startDate);
    })
    $('#form-campaign-dateEnd').datepicker({
      autoclose: true,
      container: 'html',
    });


    tinymce.init({
      selector: 'textarea',
      skin_url: '/packages/teamon_tinymce/skins/lightgray',
    });

    </script>
</template>

